# 7.1. Инфраструктура как код

## Задача 1. Выбор инструментов.

> Какой тип инфраструктуры будем использовать для этого проекта: изменяемый или не изменяемый?

Будем использовать неизменяемый тип инфраструктуры через шаблонизацию инфраструктуры. Т.е. все имзенения
будут производиться через изменения в шаблонах.

> Будет ли центральный сервер для управления инфраструктурой?

Наша инфрастурктура уже имеет некоторое количество Ansible скриптов и мы началаи активно использовать Terraform.
Следовательно центрального сервера для управления инфраструктурой не подразумевается. 

> Будут ли агенты на серверах?

Если в это понятие мы вкладываем знчение из лекции, то Ansible и Terraform не требуют установки дополнительных агентов.
Возможно в процессе эксплуатации инфрастурктуры придётся добавить некоторые агенты.

> Будут ли использованы средства для управления конфигурацией или инициализации ресурсов?
> Какие инструменты из уже используемых вы хотели бы использовать для нового проекта?

Terraform, Kubernetes, Docker и Ansible-скрипты будут использованы. 
Вероятно часть bash скриптов пришлось бы переписать в Ainsible-скрипты

> Хотите ли рассмотреть возможность внедрения новых инструментов для этого проекта?

Скорее всего это будет Prometheus в связке с Grafana для мониторинга состояния инфраструктуры и для генерации алертов.

## Задача 2

Для выполнения следующей задачи нам потребуется конкретная версия Terraform. Мне понравилась 0.12.7

```bash
 wget https://releases.hashicorp.com/terraform/0.12.7/terraform_0.12.7_linux_amd64.zip
 unzip terraform_0.12.7_linux_amd64.zip -d ~/bin 
 ~/bin/terraform --version
```

<pre>
Terraform v0.12.7

Your version of Terraform is out of date! The latest version
is 1.0.0. You can update by downloading from https://www.terraform.io/downloads.html
</pre>

Работает. Но ругается что используется устаревшая версия. Попробуем 0.13

## Задача 3

Установка чуть более свежей версии - 0.13.5

```bash
 wget https://releases.hashicorp.com/terraform/0.13.5/terraform_0.13.5_linux_amd64.zip
 unzip terraform_0.13.5_linux_amd64.zip -d ~/t13 
 ~/t13/terraform --version
```
Какая неудача - версия 0.13 тоже out of date.
<pre>
Terraform v0.13.5

Your version of Terraform is out of date! The latest version
is 1.0.0. You can update by downloading from https://www.terraform.io/downloads.html
devops@frcloud4:~$
</pre>

Но эти обстоятельства не помешают использовать обе версии, при помощи управления переменной PATH среды окружения.
Устанавливая путь к terraform в перемунной PATH, мы можем выбирать какую версию программы использовать.
Или, как вариант, использовать полный путь к программе. Но всё же лучше через переменную PATH.  
А ещё лучше завести свою переменную с полныс путём к конкретной версии terraform и использовать её в скриптах.
